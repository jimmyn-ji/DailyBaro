{"version":3,"file":"capsule.js","sources":["pages/capsule/capsule.vue","pages/capsule/capsule.vue?type=page"],"sourcesContent":["<template>\n\t<view class=\"capsule-container\">\n\t\t<view class=\"content\">\n\t\t\t<!-- 标签页 -->\n\t\t\t<view class=\"tabs\">\n\t\t\t\t<view \n\t\t\t\t\tclass=\"tab-item\" \n\t\t\t\t\t:class=\"{ active: currentStatus === 'all' }\"\n\t\t\t\t\t@tap=\"filterByStatus('all')\"\n\t\t\t\t>\n\t\t\t\t\t<text>全部</text>\n\t\t\t\t</view>\n\t\t\t\t<view \n\t\t\t\t\tclass=\"tab-item\" \n\t\t\t\t\t:class=\"{ active: currentStatus === 'pending' }\"\n\t\t\t\t\t@tap=\"filterByStatus('pending')\"\n\t\t\t\t>\n\t\t\t\t\t<text>待开启</text>\n\t\t\t\t</view>\n\t\t\t\t<view \n\t\t\t\t\tclass=\"tab-item\" \n\t\t\t\t\t:class=\"{ active: currentStatus === 'opened' }\"\n\t\t\t\t\t@tap=\"filterByStatus('opened')\"\n\t\t\t\t>\n\t\t\t\t\t<text>已开启</text>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t\n\t\t\t<!-- 胶囊列表 -->\n\t\t\t<view class=\"capsules-list\">\n\t\t\t\t<view \n\t\t\t\t\tv-for=\"capsule in filteredCapsules\" \n\t\t\t\t\t:key=\"capsule.capsuleId\" \n\t\t\t\t\tclass=\"capsule-item\"\n\t\t\t\t\t@tap=\"viewCapsule(capsule.capsuleId)\"\n\t\t\t\t>\n\t\t\t\t\t<view class=\"capsule-header\">\n\t\t\t\t\t\t<text class=\"capsule-time\">{{ formatDate(capsule.openTime) }}</text>\n\t\t\t\t\t\t<text class=\"capsule-status\" :class=\"capsule.isOpened ? 'opened' : 'pending'\">\n\t\t\t\t\t\t\t{{ getStatusText(capsule.isOpened) }}\n\t\t\t\t\t\t</text>\n\t\t\t\t\t</view>\n\t\t\t\t\t<text class=\"capsule-content\">{{ capsule.content || '暂无内容' }}</text>\n\t\t\t\t\t<view class=\"capsule-footer\">\n\t\t\t\t\t\t<text class=\"open-time\">开启时间: {{ formatDateTime(capsule.openTime) }}</text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t\n\t\t\t<!-- 创建按钮 -->\n\t\t\t<view class=\"create-section\">\n\t\t\t\t<button class=\"create-btn\" @tap=\"createCapsule\">创建胶囊</button>\n\t\t\t</view>\n\t\t</view>\n\t</view>\n</template>\n\n<script>\nimport { capsuleApi } from '../../utils/api.js'\nimport { formatDateShort, formatDateTime as formatDateTimeUtil } from '../../utils/dateUtils.js'\n\nexport default {\n\tdata() {\n\t\treturn {\n\t\t\tcapsules: [],\n\t\t\tcurrentStatus: 'all',\n\t\t\tloading: false\n\t\t}\n\t},\n\t\n\tcomputed: {\n\t\tfilteredCapsules() {\n\t\t\tif (this.currentStatus === 'all') {\n\t\t\t\treturn this.capsules\n\t\t\t}\n\t\t\t// 根据isOpened字段过滤\n\t\t\tif (this.currentStatus === 'pending') {\n\t\t\t\treturn this.capsules.filter(capsule => !capsule.isOpened)\n\t\t\t} else if (this.currentStatus === 'opened') {\n\t\t\t\treturn this.capsules.filter(capsule => capsule.isOpened)\n\t\t\t}\n\t\t\treturn this.capsules\n\t\t}\n\t},\n\t\n\tonLoad() {\n\t\tthis.loadCapsules()\n\t},\n\t\n\tonShow() {\n\t\tthis.loadCapsules()\n\t},\n\t\n\tmethods: {\n\t\tasync loadCapsules() {\n\t\t\ttry {\n\t\t\t\tconst userInfo = uni.getStorageSync('userInfo')\n\t\t\t\tif (!userInfo || !userInfo.uid) {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '请先登录',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t})\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tconst response = await capsuleApi.getCapsules(userInfo.uid)\n\t\t\t\tif (response && response.code === 200) {\n\t\t\t\t\tthis.capsules = response.data || []\n\t\t\t\t} else {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: response?.message || '获取胶囊失败',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error('加载胶囊失败:', error)\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: '加载失败，请重试',\n\t\t\t\t\ticon: 'none'\n\t\t\t\t})\n\t\t\t}\n\t\t},\n\t\t\n\t\t// 创建胶囊\n\t\tcreateCapsule() {\n\t\t\tuni.navigateTo({\n\t\t\t\turl: '/pages/capsule/create'\n\t\t\t})\n\t\t},\n\t\t\n\t\t// 查看胶囊详情\n\t\tviewCapsule(id) {\n\t\t\t// 跳转到胶囊详情页面\n\t\t\tuni.navigateTo({\n\t\t\t\turl: `/pages/capsule/detail?id=${id}`\n\t\t\t})\n\t\t},\n\t\t\n\t\t// 删除胶囊\n\t\tasync deleteCapsule(id) {\n\t\t\tuni.showModal({\n\t\t\t\ttitle: '确认删除',\n\t\t\t\tcontent: '确定要删除这个胶囊吗？',\n\t\t\t\tsuccess: async (res) => {\n\t\t\t\t\tif (res.confirm) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tconst response = await capsuleApi.deleteCapsule(id)\n\t\t\t\t\t\t\tif (response && response.code === 200) {\n\t\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\t\ttitle: '删除成功',\n\t\t\t\t\t\t\t\t\ticon: 'success'\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t// 重新加载胶囊列表\n\t\t\t\t\t\t\t\tthis.loadCapsules()\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\t\ttitle: response?.message || '删除失败',\n\t\t\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\tconsole.error('删除胶囊失败:', error)\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\ttitle: '删除失败，请重试',\n\t\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\t\n\t\t// 按状态筛选\n\t\tfilterByStatus(status) {\n\t\t\tthis.currentStatus = status\n\t\t\tuni.showToast({\n\t\t\t\ttitle: `筛选: ${status}`,\n\t\t\t\ticon: 'success'\n\t\t\t})\n\t\t},\n\t\t\n\t\t// 格式化日期\n\t\tformatDate(dateString) {\n\t\t\treturn formatDateShort(dateString)\n\t\t},\n\n\t\tformatDateTime(dateStr) {\n\t\t\treturn formatDateTimeUtil(dateStr)\n\t\t},\n\n\t\tgetStatusText(isOpened) {\n\t\t\treturn isOpened ? '已开启' : '待开启'\n\t\t}\n\t}\n}\n</script>\n\n<style scoped>\n.capsule-container {\n\tmin-height: 100vh;\n\tbackground: linear-gradient(135deg, #4a90e2 0%, #6aa8ff 100%);\n}\n\n.content {\n\tpadding: 20rpx 40rpx;\n}\n\n.tabs {\n\tdisplay: flex;\n\tgap: 20rpx;\n\tmargin-bottom: 20rpx;\n}\n\n.tab-item {\n\tflex: 1;\n\tpadding: 20rpx;\n\tborder-radius: 12rpx;\n\tfont-size: 28rpx;\n\tcolor: #64748b;\n\ttext-align: center;\n\tbackground: #f1f5f9;\n\ttransition: all 0.3s ease;\n}\n\n.tab-item.active {\n\tbackground: #4a90e2;\n\tcolor: #ffffff;\n}\n\n.capsules-list {\n\tbackground: #ffffff;\n\tborder-radius: 16rpx;\n\tpadding: 30rpx;\n\tmargin-bottom: 20rpx;\n\tbox-shadow: 0 2rpx 8rpx rgba(0, 0, 0, 0.05);\n}\n\n.capsule-item {\n\tpadding: 20rpx 0;\n\tborder-bottom: 1rpx solid #e2e8f0;\n}\n\n.capsule-item:last-child {\n\tborder-bottom: none;\n}\n\n.capsule-header {\n\tdisplay: flex;\n\tjustify-content: space-between;\n\talign-items: center;\n\tmargin-bottom: 10rpx;\n}\n\n.capsule-time {\n\tfont-size: 24rpx;\n\tcolor: #94a3b8;\n}\n\n.capsule-status {\n\tpadding: 8rpx 16rpx;\n\tborder-radius: 12rpx;\n\tfont-size: 22rpx;\n\tfont-weight: 500;\n}\n\n.capsule-status.pending {\n\tbackground: #fef3c7;\n\tcolor: #d97706;\n}\n\n.capsule-status.opened {\n\tbackground: #d1fae5;\n\tcolor: #065f46;\n}\n\n.capsule-content {\n\tfont-size: 28rpx;\n\tcolor: #1f2937;\n\tline-height: 1.6;\n\tmargin-bottom: 10rpx;\n}\n\n.capsule-footer {\n\tdisplay: flex;\n\tjustify-content: flex-end;\n}\n\n.open-time {\n\tfont-size: 24rpx;\n\tcolor: #64748b;\n}\n\n.create-section {\n\ttext-align: center;\n\tpadding: 30rpx 0;\n}\n\n.create-btn {\n\tbackground: #4a90e2;\n\tcolor: #ffffff;\n\tborder: none;\n\tborder-radius: 12rpx;\n\tpadding: 20rpx 40rpx;\n\tfont-size: 28rpx;\n}\n</style>\n","import MiniProgramPage from '/Users/minchi/Desktop/DailyBaro/DailyBaro-app/src/pages/capsule/capsule.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","capsuleApi","formatDateShort","formatDateTimeUtil"],"mappings":"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"}