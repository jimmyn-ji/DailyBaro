server:
  port: 8013

spring:
  application:
    name: ai-knowledge-service
  cloud:
    nacos:
      discovery:
        enabled: false
        server-addr: localhost:8848
      config:
        enabled: false
        server-addr: localhost:8848
        file-extension: yml
        import-check:
          enabled: false
  datasource:
    driver-class-name: com.mysql.cj.jdbc.Driver
    url: jdbc:mysql://localhost:3306/dailybaro?useUnicode=true&characterEncoding=utf-8&useSSL=false&serverTimezone=Asia/Shanghai&allowPublicKeyRetrieval=true
    username: root
    password: ${MYSQL_PASSWORD:your_mysql_password}
  servlet:
    multipart:
      max-file-size: 10MB
      max-request-size: 10MB
  data:
    redis:
      host: localhost
      port: 6379
      database: 2  # AI服务使用独立的Redis数据库
      timeout: 3000ms
      lettuce:
        pool:
          max-active: 8
          max-idle: 8
          min-idle: 0

# DeepSeek配置
deepseek:
  api-url: https://api.deepseek.com/v1/chat/completions
  api-key: ${DEEPSEEK_API_KEY:your_deepseek_api_key}
  timeout-seconds: 60  # DeepSeek API调用超时时间（秒）

# RAG配置（AI对话增强）
rag:
  enabled: true
  knowledge-service-url: http://localhost:8013  # 现在在同一个服务内
  top-k: 5  # 检索前5条最相关的知识
  timeout-seconds: 10  # RAG检索超时时间（秒），超过此时间将跳过RAG直接使用AI

# 对话历史配置
conversation:
  history:
    ttl-days: 30  # 对话历史保存30天

# Milvus 配置（向量搜索）
milvus:
  host: localhost
  port: 19530
  collection-name: knowledge_base
  dimension: 512  # 向量维度（必须与 embedding.dimension 一致！推荐512维以平衡性能和精度）

# AI Service 配置（用于 RAG，现在在同一个服务内）
ai:
  service-url: http://localhost:8013/api/ai/query

# Gateway 配置（用于调用其他服务）
gateway:
  url: http://localhost:8000

# Embedding 配置（文本向量化）
embedding:
  api-url: ${EMBEDDING_API_URL:https://api.deepseek.com/v1/embeddings}  # DeepSeek Embedding API（如果支持）
  api-key: ${EMBEDDING_API_KEY:your_embedding_api_key}   # DeepSeek API Key
  model: ${EMBEDDING_MODEL:text-embedding-3-small}  # 推荐使用 text-embedding-3-small (512维) 或 ada-002 (1536维)
  dimension: 512  # 推荐512维（平衡性能和精度，减少服务器负担）
  provider: ${EMBEDDING_PROVIDER:deepseek}  # 提供商：openai, deepseek, baidu, aliyun, huggingface, local

mybatis-plus:
  mapper-locations: classpath:mapper/*.xml
  type-aliases-package: com.dailybaro.aiknowledge.model
  configuration:
    map-underscore-to-camel-case: true
    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
  global-config:
    db-config:
      logic-delete-field: deleted
      logic-delete-value: 1
      logic-not-delete-value: 0

logging:
  level:
    com.dailybaro.aiknowledge: debug
    io.milvus: WARN  # 将 Milvus 日志级别设为 WARN，减少连接失败时的错误日志
